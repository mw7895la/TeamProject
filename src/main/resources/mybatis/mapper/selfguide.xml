<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mybatis.mapper.selfguide">
	<insert id="insertSelfGuide" parameterType="selfguide">
		insert into self_guide(snumber,stitle,scontent,swriter,register_date,stype,hit_count,simage)
		values(seq_self_guide.nextval,#{stitle},#{scontent},#{swriter},sysdate,#{stype},0,#{simage}) 	
	</insert>

	
	<select id="selectSelfGuide" parameterType="String" resultType="selfguide">
		select simage, swriter, stype ,stitle, scontent,snumber
		from Self_Guide 
		where  swriter = #{memail} 
	</select>
	
	
	<select id="countAll" resultType="int">
		select count(*) from self_guide 
	</select>
	
	<select id="selectByPage" parameterType="pager" resultType="selfguide">
		select rnum, snumber, hit_count, swriter, stitle, simage,stype
		from ( select rownum as rnum, snumber, hit_count, swriter, stitle, simage,stype 
			  from self_guide s, member m 
			  where rownum &lt;=#{endRowNo} and s.swriter=m.memail  order by snumber desc )
			  where rnum &gt; =#{startRowNo}
	</select>
	 
	
	<select id="getselfguidephotoList" parameterType="SelfGuide" resultType="SelfGuide">
		select rownum as rnum, snumber, swriter, stitle, simage, stype,hit_count
		from self_guide s, member m where s.swriter=m.memail order by snumber desc
			  
		
		
	</select>
	
	<select id="selectSelfPhotoList" parameterType="int" resultType="selfguide">
		select simage, swriter, stype ,stitle, scontent,snumber
		from Self_Guide 
		where  snumber = #{snumber}
		
	</select>
	
	<select id="selectSelfPhotoList2" parameterType="String" resultType="selfguide">
		select * from Self_Guide where swriter = #{swriter}
	</select>
	
	<select id="selectSelfListFilter" parameterType="String" resultType="selfguide">
		select simage, swriter, stype ,stitle, scontent
		from Self_Guide 
		where stype=#{stype}
	</select>

	<update id="updatehitcount" parameterType="selfguide" >
		update Self_Guide set hit_count = (select hit_count from Self_Guide where snumber = #{snumber}) +1  where snumber = #{snumber}
	</update>
</mapper>