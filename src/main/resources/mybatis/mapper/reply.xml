<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mybatis.mapper.reply">

	<!--  댓글 삽입  -->
	 <insert id="insert" parameterType="reply">
		insert into post_reply(rnumber, rcontent, pnumber, register_date, rwriter)
		values(seq_reply.nextval, #{rcontent}, #{pnumber} ,sysdate, #{rwriter})
	</insert> 
	
	
	<!-- 댓글 가져오기 -->
	 <select id="selectAll" resultType="reply">
		select rnumber, rcontent, register_date, rwriter, mimage
		from post_reply, member
		order by register_date desc
	</select> 
	
	<!-- 댓글 페이지 별로 분리하기 -->
	 <select id="selectByPage" parameterType="pager" resultType="reply">
		select rnum, rnumber, rcontent, register_date, rwriter, mimage
		from (
			select rownum as rnum,  rnumber, rcontent, register_date, rwriter, mimage
			from (
			select rnumber, rcontent, register_date, rwriter, mimage
			from post_reply p, member m
			where p.rwriter = m.memail
			order by rnumber desc
			)
			where rownum &lt; = #{endRowNo}
		)
		where rnum &gt; = #{startRowNo}
	</select> 
	
	<select id="countAll" resultType="int">
		select count(*) from post_reply
	</select>
	
	<select id="selectByRno" parameterType="int" resultType="reply">
		select rnumber, rcontent, register_date, rwriter, mimage
		from post_reply p, member m
		where p.rwriter = m.memail and p.rnumber = #{rnumber}
	</select>
	
	
	
</mapper>